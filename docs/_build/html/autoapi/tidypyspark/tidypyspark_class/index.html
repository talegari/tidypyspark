<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tidypyspark.tidypyspark_class &mdash; tidypyspark  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="prev" title="tidypyspark.datasets" href="../datasets/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            tidypyspark
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark</span></code></a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#subpackages">Subpackages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../_unexported_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark._unexported_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../accessor_class/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark.accessor_class</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../column_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark.column_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark.datasets</span></code></a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark.tidypyspark_class</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tidypyspark</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark</span></code></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark.tidypyspark_class</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/autoapi/tidypyspark/tidypyspark_class/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-tidypyspark.tidypyspark_class">
<span id="tidypyspark-tidypyspark-class"></span><h1><a class="reference internal" href="#module-tidypyspark.tidypyspark_class" title="tidypyspark.tidypyspark_class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tidypyspark.tidypyspark_class</span></code></a><a class="headerlink" href="#module-tidypyspark.tidypyspark_class" title="Permalink to this heading"></a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tidypyspark.tidypyspark_class.acc_on_pyspark" title="tidypyspark.tidypyspark_class.acc_on_pyspark"><code class="xref py py-obj docutils literal notranslate"><span class="pre">acc_on_pyspark</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tidypyspark.tidypyspark_class.</span></span><span class="sig-name descname"><span class="pre">acc_on_pyspark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark" title="Permalink to this definition"></a></dt>
<dd><dl class="py property">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.nrow">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nrow</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.nrow" title="Permalink to this definition"></a></dt>
<dd><p>nrow
get munber of rows</p>
<p class="rubric">Notes</p>
<p>Just a placeholder to inform user to use count() method</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.ncol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncol</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.ncol" title="Permalink to this definition"></a></dt>
<dd><p>ncol
get number of columns</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(Integer) Number of columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.colnames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">colnames</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.colnames" title="Permalink to this definition"></a></dt>
<dd><p>dim
get column names</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list with column names as strings</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.shape" title="Permalink to this definition"></a></dt>
<dd><p>shape
get shape</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of number of rows and number of columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.dim" title="Permalink to this definition"></a></dt>
<dd><p>dim
get shape</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of number of rows and number of columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">types</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.types" title="Permalink to this definition"></a></dt>
<dd><p>types
identify column types as strings</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>dict with column names as keys, types as a values</em></p></li>
<li><p><em>type is a string.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.rowid_to_column">
<span class="sig-name descname"><span class="pre">rowid_to_column</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.rowid_to_column" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.to_series">
<span class="sig-name descname"><span class="pre">to_series</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.to_series" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.collect" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.summarize">
<span class="sig-name descname"><span class="pre">summarize</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.summarize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.outer_join">
<span class="sig-name descname"><span class="pre">outer_join</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.outer_join" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.bind_rows">
<span class="sig-name descname"><span class="pre">bind_rows</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.bind_rows" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.nest">
<span class="sig-name descname"><span class="pre">nest</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.nest" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.fill" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.drop">
<span class="sig-name descname"><span class="pre">drop</span></span><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.drop" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._validate_by">
<span class="sig-name descname"><span class="pre">_validate_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._validate_by"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._validate_by" title="Permalink to this definition"></a></dt>
<dd><p>_validate_by
validates ‘by’ and returns a list of column names</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>by</strong> (<em>string</em><em>, </em><em>list of strings</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of column names</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._validate_order_by">
<span class="sig-name descname"><span class="pre">_validate_order_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order_by</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._validate_order_by"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._validate_order_by" title="Permalink to this definition"></a></dt>
<dd><p>_validate_order_by
validates and returns a list of ‘column’ objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order_by</strong> (<em>string</em><em> or </em><em>tuple</em><em> or </em><em>list of tuples</em>) – Order by specification, see Notes</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of ‘column’ objects</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>A ‘column’ object is an instance of ‘pyspark.sql.Column’.</p></li>
<li><p>Prototype of return objects:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>[“col_a”, (“col_b”, “desc”)] –&gt; [col(‘col_a’), col(‘col_b’).desc()]</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._validate_column_names">
<span class="sig-name descname"><span class="pre">_validate_column_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._validate_column_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._validate_column_names" title="Permalink to this definition"></a></dt>
<dd><p>_validate_column_names
validates and returns column names</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>column_names</strong> (<em>string</em><em> or </em><em>list of strings</em>) – columns names to be validated</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of column names</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._extract_order_by_cols">
<span class="sig-name descname"><span class="pre">_extract_order_by_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order_by</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._extract_order_by_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._extract_order_by_cols" title="Permalink to this definition"></a></dt>
<dd><p>_extract_order_by_cols
Extract column names from order_by specification</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order_by</strong> (<em>string</em><em> or </em><em>tuple</em><em> or </em><em>list of tuples</em>) – Order by specification
ex: [“col_a”, (“col_b”, “desc”)]</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of column names in order_by</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._create_windowspec">
<span class="sig-name descname"><span class="pre">_create_windowspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._create_windowspec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._create_windowspec" title="Permalink to this definition"></a></dt>
<dd><p>_create_windowspec
Create Window object using relevant kwargs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Supports these: by, order_by, range_between, rows_between.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of pyspark.sql.window.WindowSpec</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>_create_windowspec does not validates inputs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.glimpse">
<span class="sig-name descname"><span class="pre">glimpse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.glimpse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.glimpse" title="Permalink to this definition"></a></dt>
<dd><p>glimpse</p>
<p>This function prints the first 100(default) rows of the dataset, along with
the number of rows and columns in the dataset and the data types of each
column. It also displays the values of each column, limited to the first
100 (default) values. If the number of rows exceeds 100, then the values are
truncated accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_columns</strong> (<em>maximum number of columns to be handled</em>) – </p></li>
<li><p><strong>n_rows</strong> (<em>maximum number of rows to show</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">glimpse</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.add_row_number">
<span class="sig-name descname"><span class="pre">add_row_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'row_number'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.add_row_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.add_row_number" title="Permalink to this definition"></a></dt>
<dd><p>add_row_number
Adds a column indicating row number optionally per group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order_by</strong> (<em>order by specification</em>) – How to order before assigning row numbers.</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the new column. The default is “row_number”.</p></li>
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – Column names to group by. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_row_number</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_row_number</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;row_number&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.add_group_number">
<span class="sig-name descname"><span class="pre">add_group_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'group_number'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.add_group_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.add_group_number" title="Permalink to this definition"></a></dt>
<dd><p>add_group_number
Adds group number per group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em>) – Column names to group by</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the new column to be created. The default is “group_number”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_row_number</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;row_number&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;row_number&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_group_number</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;gn&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.to_list">
<span class="sig-name descname"><span class="pre">to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.to_list" title="Permalink to this definition"></a></dt>
<dd><p>to_list
collect a column as python list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>column_name</strong> (<em>str</em>) – Name of the column to be collected.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.pull">
<span class="sig-name descname"><span class="pre">pull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.pull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.pull" title="Permalink to this definition"></a></dt>
<dd><p>pull
collect a column as pandas series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>column_name</strong> (<em>str</em>) – Name of the column to be collected.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.to_dict" title="Permalink to this definition"></a></dt>
<dd><p>to_dict
collect as a dict where keys are column names and
values are lists</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Each column is pulled separately to reduce the load on the executor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.to_pandas">
<span class="sig-name descname"><span class="pre">to_pandas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.to_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.to_pandas" title="Permalink to this definition"></a></dt>
<dd><p>to_pandas
collect as a pandas dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.select" title="Permalink to this definition"></a></dt>
<dd><p>select
Subset some columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_names</strong> (<em>(</em><em>list of strings</em><em> or </em><em>a string</em><em>)</em>) – Names of the columns to be selected when ‘include’ is True</p></li>
<li><p><strong>include</strong> (<em>(</em><em>flag</em><em>, </em><em>default = True</em><em>)</em>) – flag to indicate whether ‘column_names’ should be selected or removed</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">],</span> <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.arrange">
<span class="sig-name descname"><span class="pre">arrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order_by</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.arrange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.arrange" title="Permalink to this definition"></a></dt>
<dd><p>arrange
Arrange rows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order_by</strong> (<em>string</em><em> or </em><em>tuple</em><em> or </em><em>list of tuples</em>) – Order by specification</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>‘arrange’ is not memory efficient as it brings all data
to a single executor.</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">arrange</span><span class="p">(</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">arrange</span><span class="p">([</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span> <span class="s1">&#39;desc&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.distinct">
<span class="sig-name descname"><span class="pre">distinct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.distinct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.distinct" title="Permalink to this definition"></a></dt>
<dd><p>distinct
Keep only distinct combinations of columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_names</strong> (<em>string</em><em> or </em><em>a list of strings</em><em>, </em><em>optional</em>) – Column names to identify distinct rows.
The default is None. All columns are considered.</p></li>
<li><p><strong>order_by</strong> (<em>order_by specification</em><em>, </em><em>optional</em>) – Columns to order by to know which rows to retain. The default is None.</p></li>
<li><p><strong>keep_all</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep all the columns. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="s1">&#39;island&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">distinct</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">distinct</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">],</span> <span class="n">keep_all</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.rename">
<span class="sig-name descname"><span class="pre">rename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_new_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.rename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.rename" title="Permalink to this definition"></a></dt>
<dd><p>rename
Rename columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>old_new_dict</strong> (<em>dict</em>) – A dict with old names as keys and new names as values</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;species_2&#39;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="s2">&quot;year_2})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.relocate">
<span class="sig-name descname"><span class="pre">relocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.relocate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.relocate" title="Permalink to this definition"></a></dt>
<dd><p>relocate
Relocate the columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_names</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – column names to be moved</p></li>
<li><p><strong>before</strong> (<em>string</em><em>, </em><em>optional</em>) – column before which the column_names are to be moved.
The default is None.</p></li>
<li><p><strong>after</strong> (<em>string</em><em>, </em><em>optional</em>) – column after which the column_names are to be moved.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Only one among ‘before’ and ‘after’ can be not None. When both are None,
the columns are added to the beginning of the dataframe (leftmost)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># move &quot;island&quot; and &quot;species&quot; columns to the left of the dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">relocate</span><span class="p">([</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># move &quot;sex&quot; and &quot;year&quot; columns to the left of &quot;island&quot; column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">relocate</span><span class="p">([</span><span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">before</span> <span class="o">=</span> <span class="s2">&quot;island&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># move &quot;island&quot; and &quot;species&quot; columns to the right of &quot;year&quot; column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">relocate</span><span class="p">([</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">],</span> <span class="n">after</span> <span class="o">=</span> <span class="s2">&quot;year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.mutate">
<span class="sig-name descname"><span class="pre">mutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.mutate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.mutate" title="Permalink to this definition"></a></dt>
<dd><p>mutate
Create new column or modify existing columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<em>dict</em>) – key should be new/existing column name.
Value should is pyspark expression that should evaluate to a column</p></li>
<li><p><strong>window_spec</strong> (<em>pyspark.sql.window.WindowSpec</em><em>, </em><em>optional</em>) – The default is None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Supports these: by</em><em>, </em><em>order_by</em><em>, </em><em>range_between</em><em>, </em><em>rows_between.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">mutate</span><span class="p">({</span><span class="s1">&#39;bl_+_1&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="s1">&#39;bl_+_1_by_2&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;bl_+_1&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># grouped and order mutate operation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_row_number</span><span class="p">(</span><span class="n">order_by</span> <span class="o">=</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">mutate</span><span class="p">({</span><span class="s1">&#39;cumsum_bl&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">)},</span>
<span class="gp">&gt;&gt;&gt; </span>               <span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;species&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>               <span class="n">order_by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span> <span class="s1">&#39;row_number&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>               <span class="n">range_between</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>               <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="s1">&#39;species&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="s1">&#39;cumsum_bl&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.summarise">
<span class="sig-name descname"><span class="pre">summarise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.summarise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.summarise" title="Permalink to this definition"></a></dt>
<dd><p>summarise
Create aggregate columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<em>dict</em>) – key should be column name.
Value should is pyspark expression that should produce a single
aggregation value</p></li>
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em>) – Column names to group by</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ungrouped summarise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">summarise</span><span class="p">({</span><span class="s1">&#39;mean_bl&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="s1">&#39;count_species&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># grouped summarise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">summarise</span><span class="p">({</span><span class="s1">&#39;mean_bl&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="s1">&#39;count_species&#39;</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;island&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.filter" title="Permalink to this definition"></a></dt>
<dd><p>filter
subset rows using some condition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>condition</strong> (<em>pyspark column</em><em> or </em><em>string</em>) – Column of types.BooleanType or a string of SQL expression.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._validate_join">
<span class="sig-name descname"><span class="pre">_validate_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._validate_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._validate_join" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._execute_on_command_for_join">
<span class="sig-name descname"><span class="pre">_execute_on_command_for_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RHS</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._execute_on_command_for_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._execute_on_command_for_join" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._execute_sql_on_command_for_join">
<span class="sig-name descname"><span class="pre">_execute_sql_on_command_for_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RHS</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._execute_sql_on_command_for_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._execute_sql_on_command_for_join" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._execute_on_x_on_y_command_for_join">
<span class="sig-name descname"><span class="pre">_execute_on_x_on_y_command_for_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">on_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RHS</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._execute_on_x_on_y_command_for_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._execute_on_x_on_y_command_for_join" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._get_sql_on_statement_with_suffix">
<span class="sig-name descname"><span class="pre">_get_sql_on_statement_with_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_names_tuple_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._get_sql_on_statement_with_suffix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._get_sql_on_statement_with_suffix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._extract_cols_from_sql_on_command">
<span class="sig-name descname"><span class="pre">_extract_cols_from_sql_on_command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql_on</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._extract_cols_from_sql_on_command"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._extract_cols_from_sql_on_command" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._get_spark_df_by_removing_suffix">
<span class="sig-name descname"><span class="pre">_get_spark_df_by_removing_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_LHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols_RHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._get_spark_df_by_removing_suffix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._get_spark_df_by_removing_suffix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._execute_cross_join">
<span class="sig-name descname"><span class="pre">_execute_cross_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._execute_cross_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._execute_cross_join" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'_y']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inner'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of y to self</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
<li><p><strong>how</strong> (<em>string</em>) – <p>Type of join to be performed. Default is ‘inner’.
Supports: ‘inner’, ‘left’, ‘right’, ‘outer’, ‘full’, ‘cross’,</p>
<blockquote>
<div><p>’semi’, ‘anti’</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (1, &quot;jordan&quot;, &#39;DS&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;DS&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;PM&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;PM&#39;)</span>
<span class="go">    ],</span>
<span class="go">    (&quot;id&quot;, &quot;name&quot;, &quot;dept&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;inner).show()</span>
<span class="go">+---+----+----+---+</span>
<span class="go">| id|dept|name|age|</span>
<span class="go">+---+----+----+---+</span>
<span class="go">|  1| SDE|jack| 20|</span>
<span class="go">|  2|  PM|jack| 30|</span>
<span class="go">|  2| SDE|jack| 10|</span>
<span class="go">+---+----+----+---+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp; (LHS.dept == RHS.dept) &amp;</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">(</span><span class="n">RHS</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span><span class="s1">&#39;, how = &#39;</span><span class="n">inner</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">())</span>
<span class="go">+---+----+----+----+------+---+</span>
<span class="go">| id|name|dept|id_y|dept_y|age|</span>
<span class="go">+---+----+----+----+------+---+</span>
<span class="go">|  1|jack| SDE|   1|   SDE| 20|</span>
<span class="go">|  2|jack| SDE|   2|   SDE| 10|</span>
<span class="go">+---+----+----+----+------+---+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.left_join">
<span class="sig-name descname"><span class="pre">left_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'_y']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.left_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.left_join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of the given pyspark_df to self by matching rows.
Includes all keys from self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># Create the DataFrames
&gt;&gt;&gt; df1 = spark.createDataFrame([</p>
<blockquote>
<div><p>(1, “jordan”, ‘DS’),
(2, “jack”, ‘DS’),
(1, “jack”, ‘SDE’),
(2, “jack”, ‘SDE’),
(1, “jack”, ‘PM’),
(2, “jack”, ‘PM’)
],
(“id”, “name”, “dept”)</p>
</div></blockquote>
<p>)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">left_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;dept&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+-----+----+---+---+</span>
<span class="go">| id|dept|  name| age|</span>
<span class="go">+---+----+------+----+</span>
<span class="go">|  1|  DS|jordan|null|</span>
<span class="go">|  2|  DS|  jack|null|</span>
<span class="go">|  1| SDE|  jack|  10|</span>
<span class="go">|  2| SDE|  jack|  20|</span>
<span class="go">|  1|  PM|  jack|null|</span>
<span class="go">|  2|  PM|  jack|  30|</span>
<span class="go">+---+----+------+----+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">left_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp;</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">(</span><span class="n">LHS</span><span class="o">.</span><span class="n">dept</span> <span class="o">==</span> <span class="n">RHS</span><span class="o">.</span><span class="n">dept</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">RHS</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span><span class="s1">&#39;).show())</span>
<span class="go">+---+------+----+----+------+----+</span>
<span class="go">| id|  name|dept|id_y|dept_y| age|</span>
<span class="go">+---+------+----+----+------+----+</span>
<span class="go">|  1|jordan|  DS|null|  null|null|</span>
<span class="go">|  2|  jack|  DS|null|  null|null|</span>
<span class="go">|  1|  jack| SDE|   1|   SDE|  20|</span>
<span class="go">|  2|  jack| SDE|   2|   SDE|  10|</span>
<span class="go">|  1|  jack|  PM|null|  null|null|</span>
<span class="go">|  2|  jack|  PM|null|  null|null|</span>
<span class="go">+---+------+----+----+------+----+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">left_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on_x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">on_y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dept&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+------+----+----+------+----+</span>
<span class="go">| id|  name|dept|id_y|dept_y| age|</span>
<span class="go">+---+------+----+----+------+----+</span>
<span class="go">|  1|jordan|  DS|null|  null|null|</span>
<span class="go">|  2|  jack|  DS|null|  null|null|</span>
<span class="go">|  1|  jack| SDE|null|  null|null|</span>
<span class="go">|  2|  jack| SDE|null|  null|null|</span>
<span class="go">|  1|  jack|  PM|null|  null|null|</span>
<span class="go">|  2|  jack|  PM|null|  null|null|</span>
<span class="go">+---+------+----+----+------+----+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.right_join">
<span class="sig-name descname"><span class="pre">right_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'_y']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.right_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.right_join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of pyspark_df to self by matching rows
Includes all keys in pyspark_df</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (1, &quot;jordan&quot;, &#39;DS&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;DS&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;PM&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;PM&#39;)</span>
<span class="go">    ],</span>
<span class="go">    (&quot;id&quot;, &quot;name&quot;, &quot;dept&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">right_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;dept&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+----+----+---+</span>
<span class="go">| id|dept|name|age|</span>
<span class="go">+---+----+----+---+</span>
<span class="go">|  2| SDE|jack| 10|</span>
<span class="go">|  1| SDE|jack| 20|</span>
<span class="go">|  2|  PM|jack| 30|</span>
<span class="go">|  2|  BA|null| 40|</span>
<span class="go">+---+----+----+---+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">right_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp;</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="p">(</span><span class="n">LHS</span><span class="o">.</span><span class="n">dept</span> <span class="o">==</span> <span class="n">RHS</span><span class="o">.</span><span class="n">dept</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">RHS</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span><span class="s1">&#39;).show())</span>
<span class="go">+----+----+----+----+------+---+</span>
<span class="go">|  id|name|dept|id_y|dept_y|age|</span>
<span class="go">+----+----+----+----+------+---+</span>
<span class="go">|   2|jack| SDE|   2|   SDE| 10|</span>
<span class="go">|   1|jack| SDE|   1|   SDE| 20|</span>
<span class="go">|null|null|null|   2|    PM| 30|</span>
<span class="go">|null|null|null|   2|    BA| 40|</span>
<span class="go">+----+----+----+----+------+---+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">right_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on_x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">],</span> <span class="n">on_y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go"># +----+----+----+----+------+---+</span>
<span class="go"># |  id|name|dept|id_y|dept_y|age|</span>
<span class="go"># +----+----+----+----+------+---+</span>
<span class="go"># |null|null|null|   2|   SDE| 10|</span>
<span class="go"># |null|null|null|   1|   SDE| 20|</span>
<span class="go"># |null|null|null|   2|    PM| 30|</span>
<span class="go"># |null|null|null|   2|    BA| 40|</span>
<span class="go"># +----+----+----+----+------+---+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.inner_join">
<span class="sig-name descname"><span class="pre">inner_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'_y']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.inner_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.inner_join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of pyspark_df to self by matching rows
Includes only matching keys in pyspark_df and self</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (1, &quot;jordan&quot;, &#39;DS&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;DS&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;PM&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;PM&#39;)</span>
<span class="go">    ],</span>
<span class="go">    (&quot;id&quot;, &quot;name&quot;, &quot;dept&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;dept&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+----+----+---+</span>
<span class="go">| id|dept|name|age|</span>
<span class="go">+---+----+----+---+</span>
<span class="go">|  1| SDE|jack| 20|</span>
<span class="go">|  2|  PM|jack| 30|</span>
<span class="go">|  2| SDE|jack| 10|</span>
<span class="go">+---+----+----+---+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp;</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="p">(</span><span class="n">LHS</span><span class="o">.</span><span class="n">dept</span> <span class="o">==</span> <span class="n">RHS</span><span class="o">.</span><span class="n">dept</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">RHS</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span><span class="s1">&#39;).show())</span>
<span class="go">+---+----+----+----+------+---+</span>
<span class="go">| id|name|dept|id_y|dept_y|age|</span>
<span class="go">+---+----+----+----+------+---+</span>
<span class="go">|  1|jack| SDE|   1|   SDE| 20|</span>
<span class="go">|  2|jack| SDE|   2|   SDE| 10|</span>
<span class="go">+---+----+----+----+------+---+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.full_join">
<span class="sig-name descname"><span class="pre">full_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'_y']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.full_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.full_join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of pyspark_df to self by matching rows
Includes all keys from both pyspark_df and self</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (1, &quot;jordan&quot;, &#39;DS&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;DS&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;SDE&#39;),</span>
<span class="go">    (1, &quot;jack&quot;, &#39;PM&#39;),</span>
<span class="go">    (2, &quot;jack&quot;, &#39;PM&#39;)</span>
<span class="go">    ],</span>
<span class="go">    (&quot;id&quot;, &quot;name&quot;, &quot;dept&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">full_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;dept&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+----+------+----+</span>
<span class="go">| id|dept|  name| age|</span>
<span class="go">+---+----+------+----+</span>
<span class="go">|  1|  DS|jordan|null|</span>
<span class="go">|  1|  PM|  jack|null|</span>
<span class="go">|  1| SDE|  jack|  20|</span>
<span class="go">|  2|  BA|  null|  40|</span>
<span class="go">|  2|  DS|  jack|null|</span>
<span class="go">|  2|  PM|  jack|  30|</span>
<span class="go">|  2| SDE|  jack|  10|</span>
<span class="go">+---+----+------+----+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">full_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp;</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">(</span><span class="n">LHS</span><span class="o">.</span><span class="n">dept</span> <span class="o">==</span> <span class="n">RHS</span><span class="o">.</span><span class="n">dept</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">RHS</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span><span class="s1">&#39;).show())</span>
<span class="go">+----+------+----+----+------+----+</span>
<span class="go">|  id|  name|dept|id_y|dept_y| age|</span>
<span class="go">+----+------+----+----+------+----+</span>
<span class="go">|   1|jordan|  DS|null|  null|null|</span>
<span class="go">|   1|  jack|  PM|null|  null|null|</span>
<span class="go">|   1|  jack| SDE|   1|   SDE|  20|</span>
<span class="go">|null|  null|null|   2|    BA|  40|</span>
<span class="go">|   2|  jack|  DS|null|  null|null|</span>
<span class="go">|   2|  jack|  PM|null|  null|null|</span>
<span class="go">|null|  null|null|   2|    PM|  30|</span>
<span class="go">|   2|  jack| SDE|   2|   SDE|  10|</span>
<span class="go">+----+------+----+----+------+----+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.anti_join">
<span class="sig-name descname"><span class="pre">anti_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.anti_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.anti_join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of pyspark_df to self by matching rows
Includes keys in self if not present in pyspark_df</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># Create the DataFrames
&gt;&gt;&gt; df1 = spark.createDataFrame([</p>
<blockquote>
<div><p>(1, “jordan”, ‘DS’),
(2, “jack”, ‘DS’),
(1, “jack”, ‘SDE’),
(2, “jack”, ‘SDE’),
(1, “jack”, ‘PM’),
(2, “jack”, ‘PM’)
],
(“id”, “name”, “dept”)</p>
</div></blockquote>
<p>)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">anti_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;dept&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+----+------+</span>
<span class="go">| id|dept|  name|</span>
<span class="go">+---+----+------+</span>
<span class="go">|  1|  DS|jordan|</span>
<span class="go">|  2|  DS|  jack|</span>
<span class="go">|  1|  PM|  jack|</span>
<span class="go">+---+----+------+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">anti_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp;</span>
<span class="go">                      (LHS.dept == RHS.dept) &amp; (RHS.age &lt; 30)&#39;).show())</span>
<span class="go">+---+------+----+</span>
<span class="go">| id|  name|dept|</span>
<span class="go">+---+------+----+</span>
<span class="go">|  1|jordan|  DS|</span>
<span class="go">|  2|  jack|  DS|</span>
<span class="go">|  1|  jack|  PM|</span>
<span class="go">|  2|  jack|  PM|</span>
<span class="go">+---+------+----+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">anti_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on_x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">],</span> <span class="n">on_y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+------+----+</span>
<span class="go">| id|  name|dept|</span>
<span class="go">+---+------+----+</span>
<span class="go">|  1|jordan|  DS|</span>
<span class="go">|  2|  jack|  DS|</span>
<span class="go">|  1|  jack| SDE|</span>
<span class="go">|  2|  jack| SDE|</span>
<span class="go">|  1|  jack|  PM|</span>
<span class="go">|  2|  jack|  PM|</span>
<span class="go">+---+------+----+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.semi_join">
<span class="sig-name descname"><span class="pre">semi_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.semi_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.semi_join" title="Permalink to this definition"></a></dt>
<dd><p>Joins columns of pyspark_df to self by matching rows
Includes keys in self if present in pyspark_df</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>on</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Common column names to match</p></li>
<li><p><strong>on_x</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of self to be matched with arg ‘on_y’</p></li>
<li><p><strong>on_y</strong> (<em>string</em><em> or </em><em>a list of strings</em>) – Column names of y to be matched with arg ‘on_x’</p></li>
<li><p><strong>sql_on</strong> (<em>string</em>) – SQL expression used to join both DataFrames.
Recommended for inequality joins.
The left table has to be specified as ‘LHS’ and the right table as ‘RHS’.
e.g. ‘(LHS.dept == RHS.dept) &amp; (LHS.age &gt;= RHS.age) &amp; (RHS.age &lt; 30)’</p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># Create the DataFrames
&gt;&gt;&gt; df1 = spark.createDataFrame([</p>
<blockquote>
<div><p>(1, “jordan”, ‘DS’),
(2, “jack”, ‘DS’),
(1, “jack”, ‘SDE’),
(2, “jack”, ‘SDE’),
(1, “jack”, ‘PM’),
(2, “jack”, ‘PM’)
],
(“id”, “name”, “dept”)</p>
</div></blockquote>
<p>)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    (2, &quot;PM&quot;, 30),</span>
<span class="go">    (2, &quot;BA&quot;, 40),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">semi_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;dept&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go"># +---+----+----+</span>
<span class="go"># | id|dept|name|</span>
<span class="go"># +---+----+----+</span>
<span class="go"># |  1| SDE|jack|</span>
<span class="go"># |  2|  PM|jack|</span>
<span class="go"># |  2| SDE|jack|</span>
<span class="go"># +---+----+----+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">semi_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sql_on</span> <span class="o">=</span> <span class="s1">&#39;(LHS.id == RHS.id) &amp;</span>
<span class="go">                      (LHS.dept == RHS.dept) &amp; (RHS.age &lt; 30)&#39;)).show()</span>
<span class="go">+---+------+----+</span>
<span class="go">| id|  name|dept|</span>
<span class="go">+---+------+----+</span>
<span class="go">|  1|jordan|  DS|</span>
<span class="go">|  2|  jack|  DS|</span>
<span class="go">|  1|  jack|  PM|</span>
<span class="go">|  2|  jack|  PM|</span>
<span class="go">+---+------+----+</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">semi_join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on_x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">],</span> <span class="n">on_y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;dept&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go"># +---+----+----+</span>
<span class="go"># | id|name|dept|</span>
<span class="go"># +---+----+----+</span>
<span class="go"># +---+----+----+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.cross_join">
<span class="sig-name descname"><span class="pre">cross_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'_y']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.cross_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.cross_join" title="Permalink to this definition"></a></dt>
<dd><p>Returns the cartesian product of two DataFrames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pyspark.sql.DataFrame</strong><strong>)</strong> (<em>pyspark_df</em>) – </p></li>
<li><p><strong>suffix</strong> (<em>list of two strings</em>) – suffix to append the columns of left and right in order to create
unique names after the join</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># Create the DataFrames
&gt;&gt;&gt; df1 = spark.createDataFrame([</p>
<blockquote>
<div><p>(1, “jordan”, ‘DS’),
(2, “jack”, ‘PM’)
],
(“id”, “name”, “dept”)</p>
</div></blockquote>
<p>)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
<span class="go">    (2, &quot;SDE&quot;, 20),</span>
<span class="go">    (1, &quot;SDE&quot;, 10),</span>
<span class="go">    ],</span>
<span class="go">  (&quot;id&quot;, &quot;dept&quot;, &quot;age&quot;)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">cross_join</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+------+----+---+----+---+</span>
<span class="go">| id| name|dept|id_y|dept_y|age_y|</span>
<span class="go">+---+------+----+---+----+---+</span>
<span class="go">|  1|jordan|  DS|  2| SDE| 20|</span>
<span class="go">|  1|jordan|  DS|  1| SDE| 10|</span>
<span class="go">|  2|  jack|  PM|  2| SDE| 20|</span>
<span class="go">|  2|  jack|  PM|  1| SDE| 10|</span>
<span class="go">+---+------+----+---+----+---+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.count" title="Permalink to this definition"></a></dt>
<dd><p>count
Count unique combinations of columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_names</strong> (<em>string</em><em> or </em><em>list of strings</em>) – Names of columns</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the count column to be created (should not be an existing
name). The default is ‘n’.</p></li>
<li><p><strong>wt</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the weight column. The default is None. When None, the number of
rows is counted</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>pen.ts.count([‘species’, ‘sex’]).show()
pen.ts.count(‘species’, name = ‘cnt’).show()
pen.ts.count(‘species’, wt = ‘body_mass_g’).show()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.add_count">
<span class="sig-name descname"><span class="pre">add_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.add_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.add_count" title="Permalink to this definition"></a></dt>
<dd><p>add_count
Add a column of counts of unique combinations of columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_names</strong> (<em>string</em><em> or </em><em>list of strings</em>) – Names of columns</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the count column to be created (should not be an existing
name). The default is ‘n’.</p></li>
<li><p><strong>wt</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the weight column. The default is None. When None, the number of
rows is counted</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_count</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_count</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;cnt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">add_count</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="n">wt</span> <span class="o">=</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.pipe">
<span class="sig-name descname"><span class="pre">pipe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.pipe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.pipe" title="Permalink to this definition"></a></dt>
<dd><p>pipe
returns func(self, …)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – function to call</p></li>
<li><p><strong>*args</strong> (<em>args</em>) – </p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Depends on func</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.pipe_tee">
<span class="sig-name descname"><span class="pre">pipe_tee</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.pipe_tee"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.pipe_tee" title="Permalink to this definition"></a></dt>
<dd><p>pipe_tee
use pipe for side-effect and return input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – function to call</p></li>
<li><p><strong>*args</strong> (<em>args</em>) – </p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Input pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.slice_min">
<span class="sig-name descname"><span class="pre">slice_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_ties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.slice_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.slice_min" title="Permalink to this definition"></a></dt>
<dd><p>slice_min
Subset top rows ordered by some column</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of rows to subset</p></li>
<li><p><strong>order_by_column</strong> (<em>string</em>) – Name of the column to order by in ascending nulls to last</p></li>
<li><p><strong>with_ties</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return all rows when ordering results in ties.
The default is True.</p></li>
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – column(s) to group by. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pyspark dataframe</em></p></li>
<li><p><em>Details</em></p></li>
<li><p><em>——-</em></p></li>
<li><p><em>The ordering always keeps null to last</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">slice_min</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">order_by_column</span> <span class="o">=</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">with_ties</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.slice_max">
<span class="sig-name descname"><span class="pre">slice_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_ties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.slice_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.slice_max" title="Permalink to this definition"></a></dt>
<dd><p>slice_max
Subset top rows ordered by some column</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of rows to subset</p></li>
<li><p><strong>order_by_column</strong> (<em>string</em>) – Name of the column to order by in descending nulls to first</p></li>
<li><p><strong>with_ties</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return all rows when ordering results in ties.
The default is True.</p></li>
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – column(s) to group by. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pyspark dataframe</em></p></li>
<li><p><em>Details</em></p></li>
<li><p><em>——-</em></p></li>
<li><p><em>The ordering always keeps null to last</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">slice_max</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">order_by_column</span> <span class="o">=</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">with_ties</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.rbind">
<span class="sig-name descname"><span class="pre">rbind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.rbind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.rbind" title="Permalink to this definition"></a></dt>
<dd><p>rbind
bind or concatenate rows of two dataframes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyspark_df</strong> (<em>pyspark dataframe</em>) – </p></li>
<li><p><strong>id</strong> (<em>str</em><em>, </em><em>optional</em>) – When not None, a id column created with value ‘left’ for self and
‘right’ for the pyspark_df.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_length_mm&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.union">
<span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyspark_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.union" title="Permalink to this definition"></a></dt>
<dd><p>rbind
bind or concatenate rows of two dataframes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyspark_df</strong> (<em>pyspark dataframe</em>) – </p></li>
<li><p><strong>id</strong> (<em>str</em><em>, </em><em>optional</em>) – When not None, a id column created with value ‘left’ for self and
‘right’ for the pyspark_df.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">slice_max</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">order_by_column</span> <span class="o">=</span> <span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">with_ties</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">slice_max</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">order_by_column</span> <span class="o">=</span> <span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">with_ties</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.pivot_wider">
<span class="sig-name descname"><span class="pre">pivot_wider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'__'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.pivot_wider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.pivot_wider" title="Permalink to this definition"></a></dt>
<dd><p>Pivot data from long to wide</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names_from</strong> (<em>string</em><em> or </em><em>list of strings</em>) – column names whose unique combinations are expected to become column
new names in the result</p></li>
<li><p><strong>values_from</strong> (<em>string</em><em> or </em><em>list of strings</em>) – column names to fill the new columns with</p></li>
<li><p><strong>values_fill</strong> (<em>scalar</em><em>, </em><em>list</em><em> or </em><em>dict</em><em> (</em><em>default is None</em><em>)</em>) – Optionally, a (scalar) value that specifies what each value should be
filled in with when missing.
This can be a dictionary if you want to apply different fill values to
different value columns.
Make sure only compatible data types are used in conjunction with
the pyspark column.
Missing values can only be filled with a scalar, or empty python
list value.</p></li>
<li><p><strong>values_fn</strong> (<em>string</em><em>(</em><em>of pyspark functions</em><em>) </em><em>or</em>) – <p>a dict of strings(of pyspark funtions) (default is None)
A function to handle multiple values per row in the result.
When a dict, keys should be a subset of arg ‘values_from’.
F.collect_list is applied by default in case nothing is specified.
The string pf pyspark functions should be passed as a string
starting with ‘F.’
This is to indicate that the function is from pyspark.
Unlist the pivot columns to scalar values if and only if:
1. values_fn is None and values_fn is None
2. all the pivot columns are of type list/array and all the pivot_cols</p>
<blockquote>
<div><p>have values with a maximum length of 1.</p>
</div></blockquote>
</p></li>
<li><p><strong>id_cols</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>default is None</em>) – Names of the columns that should uniquely identify an observation
(row) after widening (columns of the original dataframe that are
supposed to stay put)</p></li>
<li><p><strong>sep</strong> (<em>string</em><em> (</em><em>default is &quot;__&quot;</em><em>)</em>) – seperator to use while creating resulting column names</p></li>
<li><p><strong>names_prefix</strong> (<em>string</em><em> (</em><em>default is &quot;&quot;</em><em>)</em>) – prefix for new columns</p></li>
<li><p><strong>names_expand</strong> (<em>boolean</em><em> (</em><em>default is False</em><em>)</em>) – When True, he output will contain column names corresponding
to a complete expansion of all possible values in names_from.
Implicit factor levels that aren’t represented in the data will
become explicit.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">id_cols</span> <span class="o">=</span> <span class="s2">&quot;island&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">names_from</span>  <span class="o">=</span> <span class="s2">&quot;sex,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">values_from</span> <span class="o">=</span> <span class="s2">&quot;bill_length_mm&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># All three inputs: &#39;id_cols&#39;, &#39;names_from&#39;, &#39;values_from&#39; can be lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">id_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="n">names_from</span>  <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="n">values_from</span> <span class="o">=</span> <span class="s2">&quot;bill_length_mm&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">id_cols</span>       <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">,</span> <span class="n">names_from</span>  <span class="o">=</span> <span class="s2">&quot;species&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">,</span> <span class="n">values_from</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">id_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">names_from</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">values_from</span> <span class="o">=</span> <span class="s2">&quot;bill_length_mm&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">id_cols</span>       <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;island&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">,</span> <span class="n">names_from</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">,</span> <span class="n">values_from</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># when id_cols is empty, all columns except the columns from</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># `names_from` and `values_from` are considered as id_cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">,</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">],</span> <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span>    <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">,</span> <span class="n">values_from</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use some prefix for new columns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">id_cols</span>       <span class="o">=</span> <span class="s2">&quot;island&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">names_from</span>  <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">values_from</span> <span class="o">=</span> <span class="s2">&quot;bill_length_mm&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">,</span> <span class="n">names_prefix</span> <span class="o">=</span> <span class="s2">&quot;gender_&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.pivot_longer">
<span class="sig-name descname"><span class="pre">pivot_longer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_drop_na</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.pivot_longer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.pivot_longer" title="Permalink to this definition"></a></dt>
<dd><p>Pivot from wide to long
aka melt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cols</strong> (<em>list of strings</em>) – Column names to be melted.
The dtypes of the columns should match.
Leftover columns are considered as ‘id’ columns.
When include is False, ‘cols’ refers to leftover columns.</p></li>
<li><p><strong>names_to</strong> (<em>string</em><em> (</em><em>default: 'name'</em><em>)</em>) – Name of the resulting column which will hold the names of the columns
to be melted</p></li>
<li><p><strong>values_to</strong> (<em>string</em><em> (</em><em>default: 'value'</em><em>)</em>) – Name of the resulting column which will hold the values of the columns
to be melted</p></li>
<li><p><strong>include</strong> (<em>bool</em><em> (</em><em>default: True</em><em>)</em>) – If True, cols are used to melt. Else, cols are considered as ‘id’
columns and the leftover columns are melted.</p></li>
<li><p><strong>values_drop_na</strong> (<em>bool</em><em> (</em><em>default: False</em><em>)</em>) – Whether to drop the rows corresponding to missing value in the result</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">pen</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;species&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># pivot by specifying &#39;id&#39; columns to obtain the same result as above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this is helpful when there are many columns to melt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">cols</span> <span class="o">=</span> <span class="s1">&#39;species&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>               <span class="n">include</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span>               <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If you want to drop the rows corresponding to missing value in the result,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set values_drop_na to True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">values_drop_na</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._construct_pyspark_expr_from_values_from">
<span class="sig-name descname"><span class="pre">_construct_pyspark_expr_from_values_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._construct_pyspark_expr_from_values_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._construct_pyspark_expr_from_values_from" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._get_pivot_columns">
<span class="sig-name descname"><span class="pre">_get_pivot_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_expand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_from_pyspark_expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._get_pivot_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._get_pivot_columns" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._fill_missing_values_for_pivot_columns">
<span class="sig-name descname"><span class="pre">_fill_missing_values_for_pivot_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values_fill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_pivot_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._fill_missing_values_for_pivot_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._fill_missing_values_for_pivot_columns" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._unlist_pivot_cols">
<span class="sig-name descname"><span class="pre">_unlist_pivot_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values_fill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_pivot_cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._unlist_pivot_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._unlist_pivot_cols" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.nest_by">
<span class="sig-name descname"><span class="pre">nest_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.nest_by"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.nest_by" title="Permalink to this definition"></a></dt>
<dd><p>nest
nest a pyspark dataframe per group as an array of structs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – column(s) to group by.</p></li>
<li><p><strong>name</strong> (<em>string</em>) – Name of the nested column which will be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>res</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.unnest_wider">
<span class="sig-name descname"><span class="pre">unnest_wider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.unnest_wider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.unnest_wider" title="Permalink to this definition"></a></dt>
<dd><p>unnest_wider
creates multiple columns from a struct column</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>colname</strong> (<em>string</em>) – Name of the column of struct type.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.unnest_longer">
<span class="sig-name descname"><span class="pre">unnest_longer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'value'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.unnest_longer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.unnest_longer" title="Permalink to this definition"></a></dt>
<dd><p>unnest_longer
creates key and value columns from a struct column</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colname</strong> (<em>str</em>) – Name of the column of struct type.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name of the resulting key column. Default is ‘name’.</p></li>
<li><p><strong>value</strong> (<em>str</em>) – Name of the resulting value column. Default is ‘value’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.unnest">
<span class="sig-name descname"><span class="pre">unnest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.unnest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.unnest" title="Permalink to this definition"></a></dt>
<dd><p>unnest
unnests an column where each element is an array of structs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>colname</strong> (<em>string</em>) – Name of the column of struct type.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.fill_na">
<span class="sig-name descname"><span class="pre">fill_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_direction_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.fill_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.fill_na" title="Permalink to this definition"></a></dt>
<dd><p>fill_na (alias: fill)
fill missing values from neighboring rows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_direction_dict</strong> (<em>dict</em>) – key is column. value should be one among:
“up”, “down”, “updown”, “downup”</p></li>
<li><p><strong>order_by</strong> (<em>string</em><em>, </em><em>tuple</em><em> or </em><em>list of tuples</em>) – order_by specification</p></li>
<li><p><strong>by</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – Names of columns to partition by. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.drop_na">
<span class="sig-name descname"><span class="pre">drop_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'any'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.drop_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.drop_na" title="Permalink to this definition"></a></dt>
<dd><p>drop_na (alias: drop)
drop rows with null values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>how</strong> (<em>string</em><em>, </em><em>optional</em>) – “any” or “all”. The default is “any”.
If ‘any’, drop a row if it contains any nulls.
If ‘all’, drop a row only if all its values are null.</p></li>
<li><p><strong>column_names</strong> (<em>string</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – It specifies the columns to consider for null values.
If a row has null values only in the specified columns,
it will be dropped.</p></li>
<li><p><strong>thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of non-null values required to keep a row. The default is None.
This overrides how parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a DataFrame with null values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">90</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># drop rows with null values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">drop_na</span><span class="p">()</span>
<span class="go">+----+---+-----+</span>
<span class="go">|name|age|score|</span>
<span class="go">+----+---+-----+</span>
<span class="go">+----+---+-----+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># drop rows with null values in a specific column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">drop_na</span><span class="p">(</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">])</span>
<span class="go">+-----+---+-----+</span>
<span class="go">| name|age|score|</span>
<span class="go">+-----+---+-----+</span>
<span class="go">|Alice| 25| null|</span>
<span class="go">| null| 30|   90|</span>
<span class="go">+-----+---+-----+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># drop rows with null values if all values are null.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">drop_na</span><span class="p">(</span><span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="go">+-----+----+-----+</span>
<span class="go">| name| age|score|</span>
<span class="go">+-----+----+-----+</span>
<span class="go">|Alice|  25| null|</span>
<span class="go">|  Bob|null|   80|</span>
<span class="go">| null|  30|   90|</span>
<span class="go">+-----+----+-----+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># drop rows with less than 3 non-null values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">drop_na</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">+----+---+-----+</span>
<span class="go">|name|age|score|</span>
<span class="go">+----+---+-----+</span>
<span class="go">+----+---+-----+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark.replace_na">
<span class="sig-name descname"><span class="pre">replace_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark.replace_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark.replace_na" title="Permalink to this definition"></a></dt>
<dd><p>Replace missing values with a specified value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>dict</em><em> or </em><em>a scalar</em><em> or </em><em>an empty list</em>) – When a dict, key should be a column name and value should be the
value to replace by missing values of the column
When a scalar or an empty list,
missing values of all columns will be replaced with value.
A scalar value could be a string, a numeric value(int, float),
or a boolean value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tidypyspark.tidypyspark_class</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tidypyspark.datasets</span> <span class="kn">import</span> <span class="n">get_penguins_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pen</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">get_penguins_path</span><span class="p">(),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a DataFrame with null values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">90</span> <span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;marks&quot;</span><span class="p">])</span>
<span class="go">+-----+----+-----+------------+</span>
<span class="go">| name| age|score|       marks|</span>
<span class="go">+-----+----+-----+------------+</span>
<span class="go">|Alice|  25| null|[20, 30, 40]|</span>
<span class="go">|  Bob|null|   80|[10, 20, 30]|</span>
<span class="go">| null|  30|   90|        null|</span>
<span class="go">+-----+----+-----+------------+</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># replace null values with a dictionary of column names and values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">replace_na</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;marks&quot;</span><span class="p">:</span> <span class="p">[]})</span>
<span class="go">+-----+----+-----+------------+</span>
<span class="go">| name| age|score|       marks|</span>
<span class="go">+-----+----+-----+------------+</span>
<span class="go">|Alice|  25|   25|[20, 30, 40]|</span>
<span class="go">|  Bob|null|   80|[10, 20, 30]|</span>
<span class="go">|    A|  30|   90|          []|</span>
<span class="go">+-----+----+-----+------------+</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tidypyspark.tidypyspark_class.acc_on_pyspark._validate_compatible_datatypes">
<span class="sig-name descname"><span class="pre">_validate_compatible_datatypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_dtypes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/tidypyspark/tidypyspark_class.html#acc_on_pyspark._validate_compatible_datatypes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tidypyspark.tidypyspark_class.acc_on_pyspark._validate_compatible_datatypes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../datasets/index.html" class="btn btn-neutral float-left" title="tidypyspark.datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Srikanth Komala sheshachala.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>